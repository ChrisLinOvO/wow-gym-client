{"ast":null,"code":"var _jsxFileName = \"/Users/Chris/Project-traning/project-wow-fit-fronted/src/pages/articles-add-page/ArticlesAdd.jsx\";\nimport React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport ArticleLogo from \"./ArticleLogo.jpg\";\nimport \"./ArticlesAdd.scss\";\nimport axios from \"axios\";\nimport Swal from 'sweetalert2';\nimport { createStructuredSelector } from \"reselect\";\nimport { currentUserSelect } from \"../../redux/user/user-selector\";\n\nfunction ArticlesAdd(props) {\n  const {\n    currentUserData\n  } = props; //該使用者的id\n\n  const currentUserId = currentUserData ? currentUserData.id : '';\n  const currentUserImg = currentUserData ? currentUserData.memberImg : '';\n  const currentUserNickname = currentUserData ? currentUserData.memberNickname : '';\n  const [memberId] = useState(currentUserId);\n  const [memberName] = useState(\"\"); // const [articleId, setArticleId] = useState();\n\n  const [articleTitle, setArticleTitle] = useState(\"\");\n  const [articleContent, setArticleContent] = useState(\"\");\n  const [categoryName, setCategoryName] = useState(\"\");\n  const [tagName1, setTagName1] = useState(\"\");\n  const [tagName2, setTagName2] = useState(\"\");\n  const [memberImg] = useState(\"\");\n  const [articleImages, setArticleImages] = useState(ArticleLogo);\n  const [avatarFile, setAvatarFile] = useState(\"\"); //圖片上傳後轉base64存進資料庫\n\n  const handleImgChange = event => {\n    let input = event.target.files[0];\n    let reader = new FileReader();\n\n    reader.onload = function () {\n      let dataURL = reader.result;\n      setArticleImages(dataURL);\n    };\n\n    reader.readAsDataURL(input);\n  }; //上傳圖片 即時顯示\n\n\n  const handleImgDisplay = event => {\n    setAvatarFile(URL.createObjectURL(event.target.files[0]));\n    setArticleImages(event.target.files[0]);\n  };\n\n  async function addArticleToSever(item) {\n    // 注意資料格式要設定，伺服器才知道是json格式\n    // console.log(item);\n    axios.post(`http://localhost:5000/api/articles/add`, {\n      method: \"POST\",\n      credentials: \"include\",\n      // 需傳送 Cookie 必須開啟\n      headers: new Headers({\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      }),\n      data: {\n        memberId: item.memberId,\n        memberName: item.memberName,\n        // articleId: item.articleId,\n        articleTitle: item.articleTitle,\n        categoryName: item.categoryName,\n        articleContent: item.articleContent,\n        tagName1: item.tagName1,\n        tagName2: item.tagName2,\n        articleImages: item.articleImages,\n        memberImg: item.memberImg\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-add-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-add-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-member-add\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"article-member-avatar\",\n    src: currentUserImg,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, currentUserNickname)), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, \"\\u767C\\u8868\\u985E\\u5225\"), /*#__PURE__*/React.createElement(\"select\", {\n    className: \"articleAddSelect\",\n    value: categoryName,\n    onChange: event => {\n      setCategoryName(event.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, \"\\u91CD\\u8A13\\u6280\\u5DE7\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, \"\\u9AD4\\u8102\\u63A7\\u5236\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, \"\\u5065\\u5EB7\\u98F2\\u98DF\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, \"\\u63D0\\u5347\\u514D\\u75AB\\u529B\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  }, \"\\u6E1B\\u80A5\")), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }, \"\\u8F38\\u5165\\u6A19\\u7C64\"), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"articleAddTagName1\",\n    type: \"text\",\n    placeholder: \"\\u8F38\\u5165\\u6A19\\u7C64\",\n    value: tagName1,\n    className: \"articleAddTagName1\",\n    onChange: event => setTagName1(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"articleAddTagName2\",\n    type: \"text\",\n    placeholder: \"\\u8F38\\u5165\\u6A19\\u7C64\",\n    value: tagName2,\n    className: \"articleAddTagName2\",\n    onChange: event => setTagName2(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 11\n    }\n  }, \"\\u4E0A\\u50B3\\u6A94\\u6848\"), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"addImg\",\n    className: \"articleFile\",\n    type: \"file\",\n    accept: \".jpg,.png,jpeg\",\n    onChange: event => {\n      handleImgChange(event);\n      handleImgDisplay(event);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"articleAddImgBox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"articleAddImg\",\n    src: avatarFile ? avatarFile : articleImages,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-add-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }, \"\\u6A19\\u984C\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"articleTitle\",\n    value: articleTitle,\n    placeholder: \"\\u8ACB\\u8F38\\u5165\\u6A19\\u984C\",\n    className: \"articleAddInputTitle\",\n    onChange: event => setArticleTitle(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 11\n    }\n  }, \"\\u5167\\u5BB9\"), /*#__PURE__*/React.createElement(\"textarea\", {\n    name: \"addContent\",\n    className: \"articleAddContent\",\n    value: articleContent,\n    placeholder: \"\\u8ACB\\u8F38\\u5165\\u5167\\u6587\",\n    onChange: event => setArticleContent(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-add-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => {\n      props.history.push(\"/articles\");\n    },\n    className: \"articleAddCancle\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 11\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \" articleAddSubmit\",\n    type: \"button\",\n    onClick: () => {\n      Swal.fire({\n        title: '新增文章',\n        text: \"確認欄位是否已填寫!\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        confirmButtonText: '確定',\n        cancelButtonText: '取消'\n      }).then(result => {\n        if (result.value) {\n          Swal.fire('完成!', '已新增文章至討論區囉!!', 'success').then(() => {\n            if (result.value) {\n              props.history.push(\"/articles\");\n            }\n          });\n          addArticleToSever({\n            // articleId,\n            memberId,\n            memberName,\n            articleTitle,\n            categoryName,\n            articleContent,\n            tagName1,\n            tagName2,\n            articleImages,\n            memberImg\n          });\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 11\n    }\n  }, \"\\u767C\\u4F48\"))));\n}\n\nconst mapStateToProps = createStructuredSelector({\n  currentUserData: currentUserSelect\n});\nexport default withRouter(connect(mapStateToProps)(ArticlesAdd));","map":{"version":3,"sources":["/Users/Chris/Project-traning/project-wow-fit-fronted/src/pages/articles-add-page/ArticlesAdd.jsx"],"names":["React","useState","connect","withRouter","ArticleLogo","axios","Swal","createStructuredSelector","currentUserSelect","ArticlesAdd","props","currentUserData","currentUserId","id","currentUserImg","memberImg","currentUserNickname","memberNickname","memberId","memberName","articleTitle","setArticleTitle","articleContent","setArticleContent","categoryName","setCategoryName","tagName1","setTagName1","tagName2","setTagName2","articleImages","setArticleImages","avatarFile","setAvatarFile","handleImgChange","event","input","target","files","reader","FileReader","onload","dataURL","result","readAsDataURL","handleImgDisplay","URL","createObjectURL","addArticleToSever","item","post","method","credentials","headers","Headers","Accept","data","value","e","history","push","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\nimport { connect } from \"react-redux\"\nimport { withRouter } from \"react-router-dom\";\nimport ArticleLogo from \"./ArticleLogo.jpg\";\n\nimport \"./ArticlesAdd.scss\"\nimport axios from \"axios\";\nimport Swal from 'sweetalert2'\n\n\nimport { createStructuredSelector } from \"reselect\";\nimport { currentUserSelect } from \"../../redux/user/user-selector\"\n\nfunction ArticlesAdd(props) {\n  const { currentUserData } = props\n  //該使用者的id\n  const currentUserId = currentUserData ? currentUserData.id : ''\n  const currentUserImg = currentUserData ? currentUserData.memberImg : ''\n  const currentUserNickname = currentUserData ? currentUserData.memberNickname : ''\n\n\n\n  const [memberId] = useState(currentUserId);\n  const [memberName] = useState(\"\");\n  // const [articleId, setArticleId] = useState();\n  const [articleTitle, setArticleTitle] = useState(\"\");\n  const [articleContent, setArticleContent] = useState(\"\");\n  const [categoryName, setCategoryName] = useState(\"\");\n  const [tagName1, setTagName1] = useState(\"\");\n  const [tagName2, setTagName2] = useState(\"\");\n  const [memberImg] = useState(\"\");\n  const [articleImages, setArticleImages] = useState(ArticleLogo);\n  const [avatarFile, setAvatarFile] = useState(\"\");\n\n  //圖片上傳後轉base64存進資料庫\n  const handleImgChange = (event) => {\n    let input = event.target.files[0];\n    let reader = new FileReader();\n    reader.onload = function () {\n      let dataURL = reader.result;\n      setArticleImages(dataURL)\n    };\n    reader.readAsDataURL(input);\n  };\n\n  //上傳圖片 即時顯示\n\n  const handleImgDisplay = (event) => {\n\n    setAvatarFile(URL.createObjectURL(event.target.files[0]));\n\n    setArticleImages(event.target.files[0]);\n  };\n\n  async function addArticleToSever(item) {\n    // 注意資料格式要設定，伺服器才知道是json格式\n    // console.log(item);\n    axios.post(`http://localhost:5000/api/articles/add`, {\n      method: \"POST\",\n      credentials: \"include\", // 需傳送 Cookie 必須開啟\n      headers: new Headers({\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      }),\n      data: {\n        memberId: item.memberId,\n        memberName: item.memberName,\n        // articleId: item.articleId,\n        articleTitle: item.articleTitle,\n        categoryName: item.categoryName,\n        articleContent: item.articleContent,\n        tagName1: item.tagName1,\n        tagName2: item.tagName2,\n        articleImages: item.articleImages,\n        memberImg: item.memberImg,\n      },\n    });\n  }\n\n\n  return (\n    <>\n      <div className=\"article-add-container\">\n\n        <div className=\"article-add-left\">\n\n          <div className=\"article-member-add\">\n            <img\n              className=\"article-member-avatar\"\n              src={currentUserImg} alt=\"\"\n            >\n            </img>\n            <h2>{currentUserNickname}</h2>\n          </div>\n\n          <h2>發表類別</h2>\n          <select\n            className=\"articleAddSelect\"\n            value={categoryName}\n            onChange={(event) => {\n              setCategoryName(event.target.value);\n            }}\n          >\n            <option>重訓技巧</option>\n            <option>體脂控制</option>\n            <option>健康飲食</option>\n            <option>提升免疫力</option>\n            <option>減肥</option>\n          </select>\n          <h2>輸入標籤</h2>\n          <input\n            name=\"articleAddTagName1\"\n            type=\"text\"\n            placeholder=\"輸入標籤\"\n            value={tagName1}\n            className=\"articleAddTagName1\"\n            onChange={(event) => setTagName1(event.target.value)}\n          />\n\n          <input\n            name=\"articleAddTagName2\"\n            type=\"text\"\n            placeholder=\"輸入標籤\"\n            value={tagName2}\n            className=\"articleAddTagName2\"\n            onChange={(event) => setTagName2(event.target.value)}\n          />\n          <h2>上傳檔案</h2>\n          <input\n            name=\"addImg\"\n            className=\"articleFile\"\n            type=\"file\"\n            accept=\".jpg,.png,jpeg\"\n            onChange={(event) => {\n              handleImgChange(event);\n              handleImgDisplay(event);\n            }}\n          />\n          <div className=\"articleAddImgBox\">\n            <img className=\"articleAddImg\" src={avatarFile ? avatarFile : articleImages} alt=\"\" />\n          </div>\n\n        </div>\n        <div className=\"article-add-right\">\n\n          <h2>標題</h2>\n          <input\n            type=\"text\"\n            name=\"articleTitle\"\n            value={articleTitle}\n            placeholder=\"請輸入標題\"\n            className=\"articleAddInputTitle\"\n            onChange={(event) => setArticleTitle(event.target.value)}\n          />\n\n          <h2>內容</h2>\n          <textarea\n            name=\"addContent\"\n            className=\"articleAddContent\"\n            value={articleContent}\n            placeholder=\"請輸入內文\"\n            onChange={(event) => setArticleContent(event.target.value)}\n          />\n\n        </div>\n        <div className=\"article-add-footer\">\n          <button onClick={(e) => { props.history.push(\"/articles\") }} className=\"articleAddCancle\" type=\"button\">\n            取消\n          </button>\n          <button\n            className=\" articleAddSubmit\"\n            type=\"button\"\n            onClick={() => {\n              Swal.fire({\n                title: '新增文章',\n                text: \"確認欄位是否已填寫!\",\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#3085d6',\n                cancelButtonColor: '#d33',\n                confirmButtonText: '確定',\n                cancelButtonText:'取消'\n              }).then((result) => {\n                if (result.value) {\n                  Swal.fire(\n                    '完成!',\n                    '已新增文章至討論區囉!!',\n                    'success'\n                  ).then(()=>{\n                    if (result.value){\n                      props.history.push(\"/articles\")\n                    }\n                  })\n                  addArticleToSever({\n                    // articleId,\n                    memberId,\n                    memberName,\n                    articleTitle,\n                    categoryName,\n                    articleContent,\n                    tagName1,\n                    tagName2,\n                    articleImages,\n                    memberImg,\n                  });\n                 \n                }\n              })\n\n            }}\n          >\n            發佈\n          </button>\n        </div>\n\n\n      </div>\n\n\n\n    </>\n  );\n}\nconst mapStateToProps = createStructuredSelector({\n  currentUserData: currentUserSelect,\n});\nexport default withRouter(connect(mapStateToProps)(ArticlesAdd));"]},"metadata":{},"sourceType":"module"}