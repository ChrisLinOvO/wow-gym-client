{"ast":null,"code":"var _jsxFileName = \"/Users/Chris/Project-traning/project-wow-fit-fronted/src/pages/articles-update-page/ArticlesUpdate.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport \"./ArticlesUpdate.scss\";\nimport axios from \"axios\";\nimport Moment from \"react-moment\";\nimport Swal from 'sweetalert2';\nimport { createStructuredSelector } from \"reselect\";\nimport { currentUserSelect } from \"../../redux/user/user-selector\";\n\nfunction ArticlesUpdate(props) {\n  const {\n    currentUserData\n  } = props; //該使用者的id\n  // const currentUserId = currentUserData ? currentUserData.memberId : ''\n\n  const currentUserImg = currentUserData ? currentUserData.memberImg : '';\n  const currentUserNickname = currentUserData ? currentUserData.memberNickname : '';\n  console.log(currentUserData);\n  const {\n    match: {\n      params\n    }\n  } = props;\n  const {\n    articleId\n  } = params;\n  const [Data, setData] = useState(); // const [memberId, setMemberId] = useState(currentUserId);\n  // const [memberName, setMemberName] = useState(\"\");\n  // const [articleId, setArticleId] = useState(\"\");\n\n  const [articleTitle, setArticleTitle] = useState(\"\");\n  const [articleContent, setArticleContent] = useState(\"\");\n  const [categoryName, setCategoryName] = useState(\"\");\n  const [tagName1, setTagName1] = useState(\"\");\n  const [tagName2, setTagName2] = useState(\"\"); // const [memberImg, setMemberImg] = useState(\"\");\n\n  const [articleImages, setArticleImages] = useState(\"\");\n  const [avatarFile, setAvatarFile] = useState(\"\"); //圖片更新後轉base64存進資料庫\n\n  const handleImgChange = event => {\n    let input = event.target.files[0];\n    let reader = new FileReader();\n\n    reader.onload = function () {\n      let dataURL = reader.result;\n      setArticleImages(dataURL);\n    };\n\n    reader.readAsDataURL(input);\n  }; //上傳圖片 即時顯示\n\n\n  const handleImgDisplay = event => {\n    setAvatarFile(URL.createObjectURL(event.target.files[0]));\n    setArticleImages(event.target.files[0]);\n  };\n\n  useEffect(() => {\n    const FetchData = async articleId => {\n      const result = await axios(`http://localhost:5000/api/articles/articleItem/${articleId}`);\n      console.log(result);\n      setData(result.data);\n      setArticleTitle(result.articleTitle);\n      setCategoryName(result.categoryName);\n      setArticleContent(result.articleContent);\n      setArticleImages(result.articleImages);\n      setTagName1(result.tagName1);\n      setTagName2(result.tagName2);\n    };\n\n    FetchData(props.match.params.articleId);\n  }, [props.match.params.articleId]);\n\n  async function articleDataUpdate(item) {\n    console.log(item); // 注意資料格式要設定，伺服器才知道是json格式\n\n    axios.post(`http://localhost:5000/api/articles/articlesUpdate/${articleId}`, {\n      method: \"POST\",\n      credentials: \"include\",\n      // 需傳送 Cookie 必須開啟\n      headers: new Headers({\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      }),\n      data: {\n        articleId: item.articleId,\n        // memberId: item.memberId,\n        // memberName: item.memberName,\n        articleTitle: item.articleTitle,\n        categoryName: item.categoryName,\n        articleContent: item.articleContent,\n        tagName1: item.tagName1,\n        tagName2: item.tagName2,\n        articleImages: item.articleImages // memberImg: item.memberImg,\n\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, Data ? Data.map((list, index) => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-update-container\",\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-update-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-member-update\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"article-member-avatar-update\",\n    src: currentUserImg,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"articleUpdateTime\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 19\n    }\n  }, currentUserNickname), /*#__PURE__*/React.createElement(Moment, {\n    format: \"YYYY-MM-DD HH:mm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 19\n    }\n  }, list.created_at))), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }, \"\\u767C\\u8868\\u985E\\u5225\"), /*#__PURE__*/React.createElement(\"select\", {\n    className: \"articleUpdateSelect\",\n    defaultValue: list.categoryName,\n    onChange: event => {\n      setCategoryName(event.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, \"\\u91CD\\u8A13\\u6280\\u5DE7\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, \"\\u9AD4\\u8102\\u63A7\\u5236\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, \"\\u5065\\u5EB7\\u98F2\\u98DF\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 17\n    }\n  }, \"\\u63D0\\u5347\\u514D\\u75AB\\u529B\"), /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, \"\\u6E1B\\u80A5\")), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 15\n    }\n  }, \"\\u8F38\\u5165\\u6A19\\u7C64\"), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"articleUpdateTagName1\",\n    type: \"text\",\n    placeholder: \"\\u8F38\\u5165\\u6A19\\u7C64\",\n    defaultValue: list.tagName1,\n    className: \"articleUpdateTagName1\",\n    onChange: event => setTagName1(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"articleUpdateTagName2\",\n    type: \"text\",\n    placeholder: \"\\u8F38\\u5165\\u6A19\\u7C64\",\n    defaultValue: list.tagName2,\n    className: \"articleUpdateTagName2\",\n    onChange: event => setTagName2(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 15\n    }\n  }, \"\\u4E0A\\u50B3\\u6A94\\u6848\"), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"updateImg\",\n    className: \"articleFile\",\n    type: \"file\",\n    accept: \".jpg,.png\",\n    onChange: event => {\n      handleImgChange(event);\n      handleImgDisplay(event);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"articleUpdateImgBox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"articleUpdateImg\",\n    src: avatarFile ? avatarFile : list.articleImages,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-update-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 15\n    }\n  }, \"\\u6A19\\u984C\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"articleTitle\",\n    defaultValue: list.articleTitle,\n    placeholder: \"\\u8ACB\\u8F38\\u5165\\u6A19\\u984C\",\n    className: \"articleUpdateInputTitle\",\n    onChange: event => setArticleTitle(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }\n  }, \"\\u5167\\u5BB9\"), /*#__PURE__*/React.createElement(\"textarea\", {\n    name: \"updateContent\",\n    className: \"articleUpdateContent\",\n    defaultValue: list.articleContent,\n    placeholder: \"\\u8ACB\\u8F38\\u5165\\u5167\\u6587\",\n    onChange: event => setArticleContent(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"article-update-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => {\n      props.history.push(\"/articlesEdit\");\n    },\n    className: \"articleUpdateCancle\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 15\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \" articleUpdateSubmit\",\n    type: \"button\",\n    onClick: () => {\n      Swal.fire({\n        title: '更新文章',\n        text: \"確認想修改欄位是否更新!\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        confirmButtonText: '確定',\n        cancelButtonText: '取消'\n      }).then(result => {\n        if (result.value) {\n          Swal.fire('完成!', '已更新文章至討論區囉!!', 'success').then(() => {\n            if (result.value) {\n              props.history.push(\"/user\");\n            }\n          });\n          articleDataUpdate({\n            // articleId,\n            // memberId,\n            // memberName,\n            articleTitle,\n            categoryName,\n            articleContent,\n            tagName1,\n            tagName2,\n            articleImages // memberImg,\n\n          });\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 15\n    }\n  }, \"\\u66F4\\u65B0\")))) : \"\");\n}\n\nconst mapStateToProps = createStructuredSelector({\n  currentUserData: currentUserSelect\n});\nexport default withRouter(connect(mapStateToProps)(ArticlesUpdate));","map":{"version":3,"sources":["/Users/Chris/Project-traning/project-wow-fit-fronted/src/pages/articles-update-page/ArticlesUpdate.jsx"],"names":["React","useState","useEffect","connect","withRouter","axios","Moment","Swal","createStructuredSelector","currentUserSelect","ArticlesUpdate","props","currentUserData","currentUserImg","memberImg","currentUserNickname","memberNickname","console","log","match","params","articleId","Data","setData","articleTitle","setArticleTitle","articleContent","setArticleContent","categoryName","setCategoryName","tagName1","setTagName1","tagName2","setTagName2","articleImages","setArticleImages","avatarFile","setAvatarFile","handleImgChange","event","input","target","files","reader","FileReader","onload","dataURL","result","readAsDataURL","handleImgDisplay","URL","createObjectURL","FetchData","data","articleDataUpdate","item","post","method","credentials","headers","Headers","Accept","map","list","index","created_at","value","e","history","push","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport \"./ArticlesUpdate.scss\";\nimport axios from \"axios\";\nimport Moment from \"react-moment\";\nimport Swal from 'sweetalert2'\n\nimport { createStructuredSelector } from \"reselect\";\nimport { currentUserSelect } from \"../../redux/user/user-selector\"\n\nfunction ArticlesUpdate(props) {\n\n\n  const { currentUserData } = props\n  //該使用者的id\n  // const currentUserId = currentUserData ? currentUserData.memberId : ''\n  const currentUserImg = currentUserData ? currentUserData.memberImg : ''\n  const currentUserNickname = currentUserData ? currentUserData.memberNickname : ''\n\n  console.log(currentUserData)\n  const {\n    match: { params },\n  } = props;\n  const { articleId } = params;\n\n  const [Data, setData] = useState();\n\n  // const [memberId, setMemberId] = useState(currentUserId);\n  // const [memberName, setMemberName] = useState(\"\");\n  // const [articleId, setArticleId] = useState(\"\");\n  const [articleTitle, setArticleTitle] = useState(\"\");\n  const [articleContent, setArticleContent] = useState(\"\");\n  const [categoryName, setCategoryName] = useState(\"\");\n  const [tagName1, setTagName1] = useState(\"\");\n  const [tagName2, setTagName2] = useState(\"\");\n  // const [memberImg, setMemberImg] = useState(\"\");\n  const [articleImages, setArticleImages] = useState(\"\");\n  const [avatarFile, setAvatarFile] = useState(\"\");\n\n  //圖片更新後轉base64存進資料庫\n  const handleImgChange = (event) => {\n    let input = event.target.files[0];\n    let reader = new FileReader();\n    reader.onload = function () {\n      let dataURL = reader.result;\n      setArticleImages(dataURL)\n    };\n    reader.readAsDataURL(input);\n  };\n\n  //上傳圖片 即時顯示\n\n  const handleImgDisplay = (event) => {\n\n    setAvatarFile(URL.createObjectURL(event.target.files[0]));\n\n    setArticleImages(event.target.files[0]);\n  };\n  useEffect(() => {\n    const FetchData = async (articleId) => {\n      const result = await axios(\n        `http://localhost:5000/api/articles/articleItem/${articleId}`\n      );\n      console.log(result);\n      setData(result.data);\n      setArticleTitle(result.articleTitle);\n      setCategoryName(result.categoryName);\n      setArticleContent(result.articleContent);\n      setArticleImages(result.articleImages);\n      setTagName1(result.tagName1);\n      setTagName2(result.tagName2);\n\n\n    };\n    FetchData(props.match.params.articleId);\n  }, [props.match.params.articleId]);\n\n  async function articleDataUpdate(item) {\n    console.log(item);\n\n    // 注意資料格式要設定，伺服器才知道是json格式\n    axios.post(\n      `http://localhost:5000/api/articles/articlesUpdate/${articleId}`,\n      {\n        method: \"POST\",\n        credentials: \"include\", // 需傳送 Cookie 必須開啟\n        headers: new Headers({\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n\n        }),\n        data: {\n          articleId: item.articleId,\n          // memberId: item.memberId,\n          // memberName: item.memberName,\n          articleTitle: item.articleTitle,\n          categoryName: item.categoryName,\n          articleContent: item.articleContent,\n          tagName1: item.tagName1,\n          tagName2: item.tagName2,\n          articleImages: item.articleImages,\n          // memberImg: item.memberImg,\n        },\n      }\n    );\n  }\n\n  return (\n    <>\n      {Data\n        ? Data.map((list, index) => (\n          <div className=\"article-update-container\" key={index}>\n\n            <div className=\"article-update-left\">\n\n              <div className=\"article-member-update\">\n                <img\n                  className=\"article-member-avatar-update\"\n                  src={currentUserImg} alt=\"\"\n                >\n                </img>\n                <div className=\"articleUpdateTime\">\n                  <h2>{currentUserNickname}</h2>\n                  <Moment format=\"YYYY-MM-DD HH:mm\">{list.created_at}</Moment>\n                </div>\n\n              </div>\n\n              <h2>發表類別</h2>\n              <select\n                className=\"articleUpdateSelect\"\n                defaultValue={list.categoryName}\n                onChange={(event) => {\n                  setCategoryName(event.target.value);\n                }}\n              >\n                <option>重訓技巧</option>\n                <option>體脂控制</option>\n                <option>健康飲食</option>\n                <option>提升免疫力</option>\n                <option>減肥</option>\n              </select>\n              <h2>輸入標籤</h2>\n              <input\n                name=\"articleUpdateTagName1\"\n                type=\"text\"\n                placeholder=\"輸入標籤\"\n                defaultValue={list.tagName1}\n                className=\"articleUpdateTagName1\"\n                onChange={(event) => setTagName1(event.target.value)}\n              />\n\n              <input\n                name=\"articleUpdateTagName2\"\n                type=\"text\"\n                placeholder=\"輸入標籤\"\n                defaultValue={list.tagName2}\n                className=\"articleUpdateTagName2\"\n                onChange={(event) => setTagName2(event.target.value)}\n              />\n              <h2>上傳檔案</h2>\n              <input\n                name=\"updateImg\"\n                className=\"articleFile\"\n                type=\"file\"\n                accept=\".jpg,.png\"\n                onChange={(event) => {\n                  handleImgChange(event);\n                  handleImgDisplay(event);\n                }}\n              />\n              <div className=\"articleUpdateImgBox\">\n                <img className=\"articleUpdateImg\" src={avatarFile ? avatarFile : list.articleImages} alt=\"\" />\n              </div>\n\n            </div>\n            <div className=\"article-update-right\">\n\n              <h2>標題</h2>\n              <input\n                type=\"text\"\n                name=\"articleTitle\"\n                defaultValue={list.articleTitle}\n                placeholder=\"請輸入標題\"\n                className=\"articleUpdateInputTitle\"\n                onChange={(event) => setArticleTitle(event.target.value)}\n              />\n\n              <h2>內容</h2>\n              <textarea\n                name=\"updateContent\"\n                className=\"articleUpdateContent\"\n                defaultValue={list.articleContent}\n                placeholder=\"請輸入內文\"\n                onChange={(event) => setArticleContent(event.target.value)}\n              />\n\n            </div>\n            <div className=\"article-update-footer\">\n              <button onClick={(e) => { props.history.push(\"/articlesEdit\") }} className=\"articleUpdateCancle\" type=\"button\">\n                取消\n          </button>\n              <button\n                className=\" articleUpdateSubmit\"\n                type=\"button\"\n                onClick={() => {\n                  Swal.fire({\n                    title: '更新文章',\n                    text: \"確認想修改欄位是否更新!\",\n                    icon: 'warning',\n                    showCancelButton: true,\n                    confirmButtonColor: '#3085d6',\n                    cancelButtonColor: '#d33',\n                    confirmButtonText: '確定',\n                    cancelButtonText: '取消'\n                  }).then((result) => {\n                    if (result.value) {\n                      Swal.fire(\n                        '完成!',\n                        '已更新文章至討論區囉!!',\n                        'success'\n                      ).then(() => {\n                        if (result.value) {\n                          props.history.push(\"/user\");\n                        }\n                      })\n                      articleDataUpdate({\n                        // articleId,\n                        // memberId,\n                        // memberName,\n                        articleTitle,\n                        categoryName,\n                        articleContent,\n                        tagName1,\n                        tagName2,\n                        articleImages,\n                        // memberImg,\n                      });\n                    \n                    }\n                  })\n\n                }}\n              >更新</button>\n\n            </div>\n          </div>\n        ))\n        : \"\"}\n    </>\n  );\n}\nconst mapStateToProps = createStructuredSelector({\n  currentUserData: currentUserSelect,\n});\nexport default withRouter(connect(mapStateToProps)(ArticlesUpdate));"]},"metadata":{},"sourceType":"module"}